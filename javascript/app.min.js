!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){window,e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"h",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.h)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.h?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var i={width:400,height:300,autostart:!0,camera:!0,mode:"front",framerate:30,ratio:4/3,sound:!1,volume:100,mirror:!1,opacity:1,brightness:1,contrast:1,saturation:1,hue:0,invert:0,grayscale:0,sepia:0,blur:0,url:"",blend:{},filter:null,done:null,fail:null,unsupported:null},n="requestAnimationFrame"in window&&"mediaDevices"in navigator&&"Promise"in window;r.d(t,"default",(function(){return o}));class o{constructor(e,t){if(this.u=Object.assign({},i,t),n){if("string"==typeof e&&(e=document.querySelector(e)),null==e||"canvas"!==e.nodeName.toLowerCase())throw new Error("Invalid viewport, you need to pass a valid selector or HTML5 canvas element");this.viewport=e,this.viewport.width=this.u.width,this.viewport.height=this.u.height,this.v=document.createElement("video"),this.v.style.display="none",this.v.width=this.u.width,this.v.height=this.u.height,this.viewport.parentNode.insertBefore(this.v,this.viewport.nextSibling),this.g=document.createElement("div"),this.g.setAttribute("data-instacam",""),this.viewport.parentNode.insertBefore(this.g,this.viewport),this.g.appendChild(this.viewport),this.g.appendChild(this.v),this.mirror=this.u.mirror,!0===this.u.autostart&&(this.I(),this.j())}else"function"==typeof this.u.unsupported&&this.u.unsupported()}j(){try{navigator.mediaDevices.getUserMedia({audio:this.u.sound,video:(()=>!1!==this.u.camera&&{frameRate:this.u.framerate,aspectRatio:this.u.ratio,facingMode:"front"===this.u.mode?"user":"environment"})()}).then(e=>{this.$=e,this.v.srcObject=e,this.v.play(),this.volume=this.u.volume;const t=()=>{"function"!=typeof this.u.filter?this.viewport.getContext("2d").drawImage(this.v,0,0,this.u.width,this.u.height):(void 0===this.O&&(this.O=document.createElement("canvas"),this.O.style.display="none",this.O.width=this.u.width,this.O.height=this.u.height,this.viewport.parentNode.insertBefore(this.O,this.viewport.nextSibling)),this.O.getContext("2d").drawImage(this.v,0,0,this.u.width,this.u.height),this.viewport.getContext("2d").putImageData(this._(this.O.getContext("2d").getImageData(0,0,this.u.width,this.u.height)),0,0)),requestAnimationFrame(t)};requestAnimationFrame(t),"function"==typeof this.u.done&&this.u.done()}).catch(e=>{"function"==typeof this.u.fail&&this.u.fail(e)})}catch(e){"function"==typeof this.u.fail&&this.u.fail(e)}}I(){if(this.M=this.u.opacity!==i.opacity?`opacity(${this.u.opacity}) `:"",this.M+=this.u.brightness!==i.brightness?`brightness(${this.u.brightness}) `:"",this.M+=this.u.contrast!==i.contrast?`contrast(${this.u.contrast}) `:"",this.M+=this.u.saturation!==i.saturation?`saturate(${this.u.saturation}) `:"",this.M+=this.u.hue!==i.hue?`hue-rotate(${this.u.hue}deg) `:"",this.M+=this.u.invert!==i.invert?`invert(${this.u.invert}) `:"",this.M+=this.u.grayscale!==i.grayscale?`grayscale(${this.u.grayscale}) `:"",this.M+=this.u.sepia!==i.sepia?`sepia(${this.u.sepia}) `:"",this.M+=this.u.blur!==i.blur?`blur(${this.u.blur}px) `:"",this.M+=this.u.url!==i.url?`url(${this.u.url}) `:"",this.viewport.style.filter=this.M,0!==Object.keys(this.u.blend).length){void 0===this.S&&(this.S=document.createElement("div"),this.viewport.parentNode.insertBefore(this.S,this.viewport));const e=this.viewport.getBoundingClientRect();this.S.style=`position:absolute;z-index:1;width:${e.width}px;height:${e.height}px;mix-blend-mode:${this.u.blend.mode};background:${this.u.blend.color};pointer-events:none;`}else void 0!==this.S&&(this.S.parentNode.removeChild(this.S),delete this.S)}_(e){let t=e.data;try{for(let e=0;e<this.u.height;e++)for(let r=0;r<this.u.width;r++){const i=4*(this.u.width*e+r),n=this.u.filter({offset:i,x:r,y:e,red:t[i],green:t[i+1],blue:t[i+2],alpha:t[i+3]});t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3]}return e}catch(e){throw new Error("Invalid filter, you need to return a valid [red, green, blue, alpha] pixel array")}}start(){this.I(),this.j()}stop(){void 0!==this.$&&(this.$.getTracks().forEach((function(e){e.stop()})),this.v.srcObject=null)}snap(e=0,t=0,r=this.u.width,i=this.u.height){if(r<=0||i<=0)throw new Error("Invalid snap area, you need to specify a positive width and height for your image capture");return this.viewport.getContext("2d").getImageData(e,t,r,i)}save(e="png",t=1){return this.viewport.toDataURL("image/"+e,t)}mute(){this.u.muted=this.v.muted=!0}unmute(){this.u.muted=this.v.muted=!1}get mode(){return this.u.mode}set mode(e){if("string"!=typeof e||"front"!==e&&"back"!==e)throw new Error("Invalid facing mode, you need to give a valid string front|back");this.u.mode=e,this.$.getVideoTracks().forEach((function(e){e.stop()})),this.j()}get muted(){return this.v.muted}get volume(){return this.u.volume}set volume(e){if("number"!=typeof e||e<0||e>100)throw new Error("Invalid volume, you need to give a number between 0 and 100");this.v.volume=this.u.volume=e/100}get mirror(){return this.u.mirror}set mirror(e){if("boolean"!=typeof e)throw new Error("Invalid mirror mode, you need to give a boolean to enable or disable the mirror mode");let t=getComputedStyle(this.viewport).getPropertyValue("transform");t="none"!==t?t:"",this.viewport.style.transform=!0===e?`${t} scale(-1, 1)`:"",this.u.mirror=e}get opacity(){return this.u.opacity}set opacity(e){if("number"!=typeof e||e<0||e>1)throw new Error("Invalid opacity, you need to give a number between 0 and 1");this.u.opacity=e,this.I()}get brightness(){return this.u.brightness}set brightness(e){if("number"!=typeof e||e<0)throw new Error("Invalid brightness, you need to give a number above 0");this.u.brightness=e,this.I()}get contrast(){return this.u.contrast}set contrast(e){if("number"!=typeof e||e<0)throw new Error("Invalid contrast, you need to give a number above 0");this.u.contrast=e,this.I()}get saturation(){return this.u.saturation}set saturation(e){if("number"!=typeof e||e<0)throw new Error("Invalid saturation, you need to give a number above 0");this.u.saturation=e,this.I()}get hue(){return this.u.hue}set hue(e){if("number"!=typeof e||e<0||e>360)throw new Error("Invalid hue, you need to give a number between 0 and 360");this.u.hue=e,this.I()}get invert(){return this.u.invert}set invert(e){if("number"!=typeof e||e<0||e>1)throw new Error("Invalid invert, you need to give a number between 0 and 1");this.u.invert=e,this.I()}get grayscale(){return this.u.grayscale}set grayscale(e){if("number"!=typeof e||e<0||e>1)throw new Error("Invalid grayscale, you need to give a number between 0 and 1");this.u.grayscale=e,this.I()}get sepia(){return this.u.sepia}set sepia(e){if("number"!=typeof e||e<0||e>1)throw new Error("Invalid sepia, you need to give a number between 0 and 1");this.u.sepia=e,this.I()}get blur(){return this.u.blur}set blur(e){if("number"!=typeof e||e<0)throw new Error("Invalid blur, you need to give a number above 0");this.u.blur=e,this.I()}get url(){return this.u.url}set url(e){if("string"!=typeof e)throw new Error("Invalid url, you need to give a string");this.u.url=e,this.I()}get blend(){return this.u.blend}set blend(e){if("object"!=typeof e)throw new Error("Invalid blend, you need to give a valid object with {mode|color} or an empty object to disable blending");this.u.blend=e,this.I()}get filter(){return this.u.filter}set filter(e){if(null!==e&&"function"!=typeof e)throw new Error("Invalid filter, you need to give a function or null to disable the custom filtering");this.u.filter=e}get style(){return 0!==this.M.length?this.M.trim().split(" "):[]}get hardware(){if(void 0===this.$)return null;let e=this.$.getAudioTracks().filter(e=>"live"===e.readyState)[0],t=this.$.getVideoTracks().filter(e=>"live"===e.readyState)[0];return{audio:void 0===e?null:{id:e.id,name:e.label},video:void 0===t?null:{id:t.id,name:t.label}}}}}]).default},function(e,t,r){r(2),e.exports=r(3)},function(e,t,r){"use strict";r.r(t);var i=r(0),n=r.n(i);let o=document.querySelector(".camera-log"),u=document.querySelector(".camera-input"),s=document.querySelector(".camera-output"),a=new n.a(document.querySelector("canvas"),{sound:!0,volume:0,done:()=>{o.innerHTML="Instacam is working fine."},fail:e=>{o.innerHTML=`Sorry, Instacam failed to start because you didn't accept the requested permissions to access your camera, or something went wrong. <strong class="camera-log-error">Error: ${e.message}</strong>`},unsupported:()=>{o.innerHTML="Sorry, but it seems that your browser is not supporting requestAnimationFrame, mediaDevices or Promises. Try Instacam in another browser."}});function l(){document.querySelector('[name="quality"]').removeAttribute("disabled"),document.querySelector(".size").classList.remove("disabled");let e=a.save(document.querySelector('[name="format"]:checked').value,Number.parseFloat(document.querySelector('[name="quality"]').value)),t=document.createElement("img");t.setAttribute("width",400),t.setAttribute("height",300),t.setAttribute("src",e),s.innerHTML="",s.appendChild(t),document.querySelector(".size span").innerHTML=Math.round(3*e.length/4/1024)}Array.from(document.querySelectorAll('.field-property + [type="range"]')).forEach(e=>{const t=e.parentNode.querySelector(".field-value");e.setAttribute("data-default",e.value),e.addEventListener("input",()=>{if(t.innerHTML=e.value,a[e.name]=Number.parseFloat(e.value),"volume"===e.name){const t=document.querySelector(".volume-state use");e.value<30?t.setAttribute("xlink:href","picture/sprite.svg#volume-mute"):e.value>=30&&e.value<=70?t.setAttribute("xlink:href","picture/sprite.svg#volume-down"):e.value>70&&t.setAttribute("xlink:href","picture/sprite.svg#volume-up")}}),["mousedown","touchstart"].forEach(r=>{e.addEventListener(r,()=>{t.innerHTML=e.value,t.classList.add("field-update")})}),["mouseup","touchend"].forEach(r=>{e.addEventListener(r,()=>{t.classList.remove("field-update")})})}),Array.from(document.querySelectorAll('[name="blend"]')).forEach(e=>{e.addEventListener("change",()=>{a.blend="none"===e.value?{}:{mode:e.value,color:getComputedStyle(u).getPropertyValue("background-color")}})}),Array.from(document.querySelectorAll('[name="filter"]')).forEach(e=>{e.addEventListener("change",()=>{const t={none:null,noise:e=>{let t=Math.random();return[t*e.red,t*e.green,t*e.blue,e.alpha]},grayscale:e=>{let t=.2126*e.red+.7152*e.green+.0722*e.blue;return[t,t,t,e.alpha]},invert:e=>[255-e.red,255-e.green,255-e.blue,e.alpha],threshold:e=>.2126*e.red+.7152*e.green+.0722*e.blue>=100?[255,255,255,255]:[0,0,0,255],sobel:e=>{let t=Math.abs(e.x),r=Math.abs(e.y);return[e.red+t,e.green+r,e.blue+(t+r)/4,255]},pixel:e=>e.offset%10!=0?[window.red,window.green,window.blue,255]:(window.red=e.red,window.green=e.green,window.blue=e.blue,[e.red,e.green,e.blue,255])};a.filter=t[e.value]})}),Array.from(document.querySelectorAll('[name="mirror"]')).forEach(e=>{e.addEventListener("change",()=>{a.mirror="1"===e.value})}),document.querySelector('[name="snap"]').addEventListener("click",()=>{let e=a.snap(),t=document.createElement("canvas");t.setAttribute("width",400),t.setAttribute("height",300),t.getContext("2d").putImageData(e,0,0),t.classList.add("cell","camera-thumbnail"),(null!==s.querySelector("img")||s.querySelectorAll("canvas").length>=12)&&(s.innerHTML=""),s.appendChild(t)}),Array.from(document.querySelectorAll('[name="format"]')).forEach(e=>{e.addEventListener("change",()=>{l()})}),document.querySelector('[name="quality"]').addEventListener("input",()=>{l()})},function(e,t,r){}]);